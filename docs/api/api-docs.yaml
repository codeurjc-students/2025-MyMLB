openapi: 3.1.0
info:
  title: OpenAPI definition
  version: v0
servers:
- url: https://localhost:8443
  description: Generated server url
tags:
- name: Authentication
  description: Endpoints related to user authentication
- name: Teams
  description: Operations related to MLB teams and standings
- name: Matches
  description: Operations related to the matches
paths:
  /api/auth/reset-password:
    post:
      tags:
      - Authentication
      summary: Reset user password
      description: Allows the user to set a new password using a valid recovery code.
      operationId: resetPassword
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResetPasswordRequest"
        required: true
      responses:
        "200":
          description: Password successfully reset
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
              example:
                status: SUCCESS
                message: Password restored
        "400":
          description: Invalid or expired recovery code
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/AuthResponse"
  /api/auth/register:
    post:
      tags:
      - Authentication
      summary: Register new user
      description: Creates a new user account in the system.
      operationId: register
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegisterRequest"
        required: true
      responses:
        "200":
          description: User successfully registered
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
              example:
                status: SUCCESS
                message: User registered successfully
        "400":
          description: Invalid registration data
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/AuthResponse"
        "409":
          description: User already exists in the database
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/AuthResponse"
  /api/auth/refresh:
    post:
      tags:
      - Authentication
      summary: Refresh JWT token
      description: Generates new JWT tokens using the refresh token stored in cookies.
      operationId: refreshToken
      parameters:
      - name: RefreshToken
        in: cookie
        description: Refresh token (from cookie named RefreshToken)
        required: false
        schema:
          type: string
      responses:
        "200":
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
              example:
                status: SUCCESS
                message: Tokens refreshed
        "401":
          description: Invalid or expired refresh token
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/AuthResponse"
  /api/auth/logout:
    post:
      tags:
      - Authentication
      summary: User logout
      description: Clears authentication cookies and invalidates session tokens.
      operationId: logOut
      responses:
        "200":
          description: Logout successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
              example:
                status: SUCCESS
                message: logout successfully
  /api/auth/login:
    post:
      tags:
      - Authentication
      summary: User login
      description: Authenticates the user and returns JWT tokens (access and refresh).
      operationId: login
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
        required: true
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
              example:
                status: SUCCESS
                message: Auth successful. Tokens are created in cookie.
        "401":
          description: Invalid credentials
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/AuthResponse"
  /api/auth/forgot-password:
    post:
      tags:
      - Authentication
      summary: Request password recovery
      description: Sends a recovery email to the user containing a reset link or verification
        code.
      operationId: forgotPassword
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForgotPasswordRequest"
        required: true
      responses:
        "200":
          description: Recovery email sent successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
              example:
                status: SUCCESS
                message: Recovery email sent successfully
        "400":
          description: Invalid email address
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/AuthResponse"
        "404":
          description: There is no user registered with this email
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/AuthResponse"
  /api/users:
    get:
      tags:
      - user-controller
      operationId: getUsers
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ShowUser"
  /api/teams:
    get:
      tags:
      - Teams
      summary: Get all teams
      description: "Returns a list of all MLB teams with calculated stats, including\
        \ wins, losses, total games, and win percentage."
      operationId: getAllTeams
      responses:
        "200":
          description: Successfully retrieved list of teams
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TeamDTO"
              example:
              - name: Yankees
                abbreviation: NYY
                logo: url
                league: AL
                division: EAST
                totalGames: 162
                wins: 95
                losses: 67
                pct: 0.586
                gamesBack: 0.0
                streak: W3
        "500":
          description: Internal server error
          content:
            application/json: {}
  /api/teams/standings:
    get:
      tags:
      - Teams
      summary: Get team standings
      description: "Returns standings grouped by league and division, ordered by win\
        \ percentage. Each team includes stats such as total games, wins, losses,\
        \ win percentage, games back, and current streak."
      operationId: getStandings
      responses:
        "200":
          description: Successfully retrieved standings
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TeamDTO"
              example:
                AL:
                  EAST:
                  - name: Yankees
                    abbreviation: NYY
                    logo: url
                    league: AL
                    division: EAST
                    totalGames: 162
                    wins: 95
                    losses: 67
                    pct: 0.586
                    gamesBack: 0.0
                    streak: W3
        "500":
          description: Internal server error
          content:
            application/json: {}
  /api/matches/today:
    get:
      tags:
      - Matches
      summary: Get the matches of the day
      description: "Returns a list of matches scheduled for today. Each match includes\
        \ the home and away teams, scores, scheduled date/time, and current status\
        \ (Scheduled, InProgress, Finished)."
      operationId: getMatchesOfTheDay
      responses:
        "200":
          description: Successfully retrieved the matches
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MatchDTO"
              example:
              - homeTeam:
                  name: Los Angeles Dodgers
                  abbreviation: LAD
                awayTeam:
                  name: New York Yankees
                  abbreviation: NYY
                homeScore: 0
                awayScore: 0
                date: 2025-10-20 19:00
                status: Scheduled
              - homeTeam:
                  name: Toronto Blue Jays
                  abbreviation: TOR
                awayTeam:
                  name: Detroit Tigers
                  abbreviation: DET
                homeScore: 3
                awayScore: 2
                date: 2025-10-20 21:00
                status: InProgress
        "500":
          description: Internal server error
          content:
            application/json: {}
  /api/auth/me:
    get:
      tags:
      - Authentication
      summary: Get the active user
      description: Obtain details of the currently authenticated user.
      operationId: getActiveUser
      responses:
        "200":
          description: User successfully authenticated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserRole"
              example:
                username: johndoe
                roles:
                - USER
        "401":
          description: User not authenticated
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/UserRole"
components:
  schemas:
    AuthResponse:
      type: object
      properties:
        status:
          type: string
          enum:
          - SUCCESS
          - FAILURE
        message:
          type: string
        error:
          type: string
    ResetPasswordRequest:
      type: object
      properties:
        code:
          type: string
          pattern: "\\d{4}"
        newPassword:
          type: string
      required:
      - code
      - newPassword
    RegisterRequest:
      type: object
      properties:
        email:
          type: string
        username:
          type: string
        password:
          type: string
      required:
      - email
      - password
      - username
    LoginRequest:
      type: object
      properties:
        username:
          type: string
        password:
          type: string
      required:
      - password
      - username
    ForgotPasswordRequest:
      type: object
      properties:
        email:
          type: string
      required:
      - email
    ShowUser:
      type: object
      properties:
        username:
          type: string
        email:
          type: string
    TeamDTO:
      type: object
      properties:
        name:
          type: string
        abbreviation:
          type: string
        league:
          type: string
          enum:
          - AL
          - NL
        division:
          type: string
          enum:
          - EAST
          - CENTRAL
          - WEST
        totalGames:
          type: integer
          format: int32
          maximum: 162
          minimum: 0
        wins:
          type: integer
          format: int32
          maximum: 162
          minimum: 0
        losses:
          type: integer
          format: int32
          maximum: 162
          minimum: 0
        pct:
          type: number
          format: double
          maximum: 1.0
          minimum: 0.0
        gamesBehind:
          type: number
          format: double
          minimum: 0.0
        lastTen:
          type: string
      required:
      - abbreviation
      - division
      - lastTen
      - league
      - name
    MatchDTO:
      type: object
      properties:
        homeTeam:
          $ref: "#/components/schemas/TeamSummary"
        awayTeam:
          $ref: "#/components/schemas/TeamSummary"
        homeScore:
          type: integer
          format: int32
          minimum: 0
        awayScore:
          type: integer
          format: int32
          minimum: 0
        date:
          type: string
          format: date-time
        status:
          type: string
          enum:
          - Scheduled
          - InProgress
          - Finished
      required:
      - awayTeam
      - date
      - homeTeam
      - status
    TeamSummary:
      type: object
      properties:
        name:
          type: string
        abbreviation:
          type: string
    UserRole:
      type: object
      properties:
        username:
          type: string
        roles:
          type: array
          items:
            type: string
      required:
      - username
