import{a as P,b as R}from"./chunk-WRMX7LJS.js";import{a as O}from"./chunk-O33IWDLJ.js";import{a as H}from"./chunk-6MSJJXHK.js";import{b as $}from"./chunk-EIZO4MGF.js";import{a as N}from"./chunk-NRPEG6UI.js";import"./chunk-IZW5FDFG.js";import{a as z,b as U}from"./chunk-HDDW6YC7.js";import"./chunk-UM6U26ZR.js";import{Aa as M,Ab as h,Bb as V,Cb as D,Da as l,G as x,Ia as _,Ib as A,Jb as E,Pa as w,Qb as b,Rb as C,bb as T,ca as c,cb as y,da as m,db as f,ea as S,gb as F,hb as k,ib as u,jb as s,kb as o,lb as g,lc as B,nc as j,pb as d,qb as p,rc as I,sb as r}from"./chunk-GAK5OYFS.js";var G=(n,t)=>t.abbreviation;function Y(n,t){if(n&1){let e=d();s(0,"div",3)(1,"button",8),p("click",function(){c(e);let a=r();return m(a.loadTeams())}),h(2,"Add Favorite Team"),o()()}}function q(n,t){if(n&1){let e=d();s(0,"div",10)(1,"div",15),p("click",function(){let a=c(e).$implicit,v=r(2);return m(v.selectTeam(a.name))}),g(2,"img",16),o(),s(3,"div",17)(4,"span",18),h(5),o(),s(6,"button",19),p("click",function(){let a=c(e).$implicit,v=r(2);return m(v.openDeleteModal(a))}),S(),s(7,"svg",20),g(8,"path",21),o()()()()}if(n&2){let e=t.$implicit,i=r(2);l(),u("ngClass",i.backgroundService.getBackgroundColor(e.abbreviation)),l(),u("src",E("assets/team-logos-new/",e.league,"/",e.division,"/",e.abbreviation,".png"),M)("alt",A("",e.name," Logo")),l(3),V(e.name)}}function J(n,t){if(n&1){let e=d();s(0,"section",4)(1,"div",9),F(2,q,9,8,"div",10,G),b(4,"async"),o(),s(5,"div",11)(6,"button",12),p("click",function(){c(e);let a=r();return m(a.loadTeams())}),g(7,"span",13),s(8,"span",14),h(9,"Add Favorite Team"),o()()()()}if(n&2){let e=r();l(2),k(C(4,0,e.favTeams$))}}function K(n,t){if(n&1){let e=d();s(0,"app-success-modal",22),p("continue",function(){c(e);let a=r();return m(a.showSuccessModal=!1)}),o()}if(n&2){let e=r();u("message",e.successMessage)}}function Q(n,t){if(n&1){let e=d();s(0,"app-remove-confirmation-modal",23),p("confirm",function(){c(e);let a=r();return m(a.confirmDeleteTeam())})("cancel",function(){c(e);let a=r();return m(a.cancelDeleteModal())}),o()}n&2&&u("title","Are you sure you want to remove this team as favorite?")("contentMessage","This action cannot be undone. The team will be removed from your favorites.")("buttonContent","Yes, Remove")("isDelete",!0)}var L=class n{constructor(t,e,i,a){this.userService=t;this.backgroundService=e;this.teamService=i;this.authService=a}favTeams$;username="";errorMessage="";successMessage="";showDeleteModal=!1;teamToDelete;showSuccessModal=!1;addButtonClicked=!1;availableTeams=[];visibleTeams=[];pageSize=10;currentPage=0;isClose=!1;hasMore;ngOnInit(){this.favTeams$=this.userService.favTeams$,this.userService.getFavTeams(),this.getUsername()}getUsername(){this.authService.getActiveUser().subscribe({next:t=>this.username=t.username,error:t=>this.errorMessage="Unexpected error while retrieving the user"})}updateAvailableTeams(t){this.favTeams$.pipe(x(1)).subscribe(e=>{this.availableTeams=t.filter(i=>!e.some(a=>a.name===i.name)),this.currentPage=0,this.visibleTeams=this.availableTeams.slice(0,this.pageSize),this.hasMore=this.visibleTeams.length<this.availableTeams.length})}loadTeams(){this.addButtonClicked=!0,this.errorMessage="",this.teamService.getTeamsNamesAndAbbr().subscribe({next:t=>this.updateAvailableTeams(t),error:t=>this.errorMessage="Error while loading the teams"})}addFavoriteTeam(t){let e=t;this.errorMessage="",this.successMessage="",this.userService.addFavTeam(e).subscribe({next:i=>{this.successMessage="Team successfully added",this.showSuccessModal=!0,this.userService.getFavTeams(),this.teamService.getTeamsNamesAndAbbr().subscribe(a=>{this.updateAvailableTeams(a)})},error:i=>this.errorMessage=i.message})}closeTeamModal=()=>{this.isClose=!0,setTimeout(()=>{this.addButtonClicked=!1,this.isClose=!1},300)};openDeleteModal(t){this.showDeleteModal=!0,this.teamToDelete=t}cancelDeleteModal(){this.showDeleteModal=!1}confirmDeleteTeam(){this.errorMessage="",this.successMessage="",this.userService.removeFavTeam(this.teamToDelete).subscribe({next:t=>{this.showDeleteModal=!1,this.successMessage="Team successfully removed",this.showSuccessModal=!0,this.userService.getFavTeams(),this.teamService.getTeamsNamesAndAbbr().subscribe(e=>{this.updateAvailableTeams(e)})},error:t=>this.errorMessage=t.message})}selectTeam(t){this.teamService.selectTeam(t).subscribe({error:e=>this.errorMessage=e.message})}loadMoreTeams(){this.currentPage++;let t=this.currentPage*this.pageSize,e=t+this.pageSize;this.visibleTeams=[...this.visibleTeams,...this.availableTeams.slice(t,e)],this.hasMore=this.visibleTeams.length<this.availableTeams.length}loadMoreTeamsCondition(){return this.hasMore=this.visibleTeams.length<this.availableTeams.length,this.hasMore}static \u0275fac=function(e){return new(e||n)(_(R),_(N),_($),_(P))};static \u0275cmp=w({type:n,selectors:[["app-fav-team"]],decls:10,vars:12,consts:[[1,"app-background","min-h-screen","text-gray-900","dark:text-white","px-6","py-16","space-y-24","flex","flex-col","items-center"],[1,"w-full","flex","justify-center","text-center","overflow-visible"],[1,"app-page-titles"],[1,"flex","justify-center"],[1,"w-full","max-w-6xl","team-section-container"],[3,"select","loadNextPageFunction","closeModal","teamElements","openModal","isClose","hasMore","elements","appEscapeClose"],[3,"message"],[3,"title","contentMessage","buttonContent","isDelete"],[1,"px-6","py-3","app-button","hover:scale-105",3,"click"],[1,"grid","grid-cols-2","md:grid-cols-4","lg:grid-cols-6","gap-x-14","gap-y-16","justify-center"],[1,"flex","flex-col","items-center","space-y-3","relative","text-center"],[1,"mt-12","flex","justify-center"],[1,"px-6","py-3","app-button","group","tracking-widest",3,"click"],[1,"app-button-bright"],[1,"app-button-texts"],["id","team-container",1,"w-32","h-32","rounded-full","shadow-lg","flex","items-center","justify-center","cursor-pointer",3,"click","ngClass"],[1,"w-24","h-24","object-contain","cursor-pointer","hover:animate-scale",3,"src","alt"],[1,"flex","items-center","justify-center","gap-2"],[1,"text-lg","font-semibold","text-center"],["title","Remove team",1,"text-red-500","hover:text-red-700","transition","cursor-pointer",3,"click"],["fill","currentColor","viewBox","0 0 20 20","xmlns","http://www.w3.org/2000/svg",1,"w-5","h-5"],["fill-rule","evenodd","d","M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule","evenodd"],[3,"continue","message"],[3,"confirm","cancel","title","contentMessage","buttonContent","isDelete"]],template:function(e,i){if(e&1&&(s(0,"div",0)(1,"section",1)(2,"h1",2),h(3),o()(),T(4,Y,3,0,"div",3),b(5,"async"),y(6,J,10,2,"section",4),s(7,"app-select-element-modal",5),p("select",function(v){return i.addFavoriteTeam(v)})("loadNextPageFunction",function(){return i.loadMoreTeams()})("closeModal",function(){return i.closeTeamModal()}),o(),T(8,K,1,1,"app-success-modal",6),T(9,Q,1,4,"app-remove-confirmation-modal",7),o()),e&2){let a;l(3),D(" ",i.username,"'s Favorite Teams "),l(),f(((a=C(5,10,i.favTeams$))==null?null:a.length)===0?4:6),l(3),u("teamElements",!0)("openModal",i.addButtonClicked)("isClose",i.isClose)("hasMore",i.hasMore)("elements",i.visibleTeams)("appEscapeClose",i.closeTeamModal),l(),f(i.showSuccessModal?8:-1),l(),f(i.showDeleteModal?9:-1)}},dependencies:[I,B,O,U,H,z,j],encapsulation:2})};export{L as FavTeamComponent};
