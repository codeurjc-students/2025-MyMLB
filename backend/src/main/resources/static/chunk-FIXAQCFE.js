import{C as l,R as i,U as o,Y as u,l as s,o as p,xc as a}from"./chunk-GAK5OYFS.js";var n=class r{constructor(e){this.http=e;this.fetchInitialUserStatus()}apiUrl="https://localhost:8443/api/v1/auth";defaultGuestUser={username:"",roles:["GUEST"]};currentUserSubject=new s(this.defaultGuestUser);currentUser$=this.currentUserSubject.asObservable();fetchInitialUserStatus(){this.getActiveUser().pipe(i(e=>this.currentUserSubject.next(e)),l(e=>(this.currentUserSubject.next(this.defaultGuestUser),p(this.defaultGuestUser)))).subscribe()}getActiveUser(){return this.http.get(`${this.apiUrl}/me`,{withCredentials:!0})}setCurrentUser(e){this.currentUserSubject.next(e)}get currentUser(){return this.currentUserSubject.value}loginUser(e){return this.http.post(`${this.apiUrl}/login`,e,{withCredentials:!0}).pipe(i(()=>{this.getActiveUser().subscribe(t=>this.currentUserSubject.next(t))}))}registerUser(e){return this.http.post(`${this.apiUrl}/register`,e)}logoutUser(){return this.http.post(`${this.apiUrl}/logout`,{},{withCredentials:!0}).pipe(i(()=>this.currentUserSubject.next(this.defaultGuestUser)))}deleteAccount(){return this.http.delete(this.apiUrl,{withCredentials:!0}).pipe(i(()=>this.currentUserSubject.next(this.defaultGuestUser)))}forgotPassword(e){return this.http.post(`${this.apiUrl}/forgot-password`,e)}resetPassword(e){return this.http.post(`${this.apiUrl}/reset-password`,e)}silentRefresh(){return this.http.post(`${this.apiUrl}/refresh`,{},{withCredentials:!0})}handleSessionExpired(){this.currentUserSubject.next(this.defaultGuestUser),window.location.pathname.includes("/edit-menu")?window.location.href="/error":window.location.href="/auth"}static \u0275fac=function(t){return new(t||r)(u(a))};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};var h=class r{constructor(e){this.http=e}apiUrl="https://localhost:8443/api/v1/users";favTeamsSubject=new s([]);favTeams$=this.favTeamsSubject.asObservable();profilePictureSubject=new s("");profilePicture$=this.profilePictureSubject.asObservable();getUserProfile(){return this.http.get(`${this.apiUrl}/profile`,{withCredentials:!0})}editProfile(e){return this.http.patch(this.apiUrl,e,{withCredentials:!0})}editProfilePicture(e){let t=new FormData;return t.append("file",e),this.http.post(`${this.apiUrl}/picture`,t)}deleteProfilePicture(){return this.http.delete(`${this.apiUrl}/picture`)}setProfilePicture(e){this.profilePictureSubject.next(e)}getFavTeams(){this.http.get(`${this.apiUrl}/favorites/teams`,{withCredentials:!0}).subscribe({next:e=>this.favTeamsSubject.next(e)})}getSelectedFavTeams(){return this.favTeamsSubject.getValue()}addFavTeam(e){return this.http.post(`${this.apiUrl}/favorites/teams/${e.name}`,{},{withCredentials:!0})}removeFavTeam(e){return this.http.delete(`${this.apiUrl}/favorites/teams/${e.name}`,{withCredentials:!0})}getPurchasedTickets(){return this.http.get(`${this.apiUrl}/tickets`,{withCredentials:!0})}static \u0275fac=function(t){return new(t||r)(u(a))};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};export{n as a,h as b};
