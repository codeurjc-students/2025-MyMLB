import{C as l,N as n,j as a}from"./chunk-J7PLGMTS.js";var c=class r{items$=new a([]);rawItems=[];currentPage=0;hasMore=!0;loading=!1;excludedLabels=new Set;currentSelectionLabel;labelFn=null;setLabelFn(e){this.labelFn=e,this.refreshView()}exclude(e){this.excludedLabels.add(e),this.refreshView()}loadPage(e,t,i){this.loading||(this.loading=!0,i(e,t).pipe(l(()=>this.loading=!1)).subscribe({next:s=>{this.rawItems=[...this.rawItems,...s.content],this.currentPage=s.page.number,this.hasMore=s.page.totalPages>this.currentPage+1,this.refreshView()},error:()=>{this.items$.error("Error loading items")}}))}loadNextPage(e,t){this.hasMore&&this.loadPage(this.currentPage+1,e,t)}select(e,t){let i=t(e);return this.currentSelectionLabel&&this.excludedLabels.delete(this.currentSelectionLabel),this.excludedLabels.add(i),this.currentSelectionLabel=i,this.refreshView(),i}clearSelection(){this.currentSelectionLabel&&(this.excludedLabels.delete(this.currentSelectionLabel),this.currentSelectionLabel=void 0,this.refreshView())}reset(){this.rawItems=[],this.items$.next([]),this.currentPage=0,this.hasMore=!0}clearAll(){this.rawItems=[],this.items$.next([]),this.currentSelectionLabel=void 0,this.excludedLabels.clear(),this.currentPage=0,this.hasMore=!0}refreshView(){if(!this.labelFn){this.items$.next(this.rawItems.slice());return}let e=this.rawItems.filter(t=>!this.excludedLabels.has(this.labelFn(t)));this.items$.next(e)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=n({token:r,factory:r.\u0275fac,providedIn:"root"})};export{c as a};
