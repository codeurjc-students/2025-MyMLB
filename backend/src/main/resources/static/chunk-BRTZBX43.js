import{a as V}from"./chunk-FJVN3JVV.js";import{a as Y}from"./chunk-E2OKA6XF.js";import{a as W,c as $,e as z,r as A,t as G}from"./chunk-332QIL6S.js";import{a as U,b as q}from"./chunk-HDDW6YC7.js";import"./chunk-UM6U26ZR.js";import{Ab as a,Cb as g,Da as s,Eb as j,Fb as P,Gb as L,Pa as C,Qb as I,Sb as E,Ua as T,Z as y,bb as m,ca as k,da as _,db as u,ea as F,gb as v,hb as M,ib as d,jb as n,kb as r,lb as x,lc as R,mb as S,nb as w,oc as D,pb as f,qb as c,rb as O,rc as b,sb as l}from"./chunk-GAK5OYFS.js";var N=class t{ticket;open=new T;static \u0275fac=function(e){return new(e||t)};static \u0275cmp=C({type:t,selectors:[["app-support-ticket-item"]],inputs:{ticket:"ticket"},outputs:{open:"open"},decls:8,vars:6,consts:[[1,"p-5","rounded-xl","bg-white","dark:bg-gray-900","shadow-md","border","border-gray-200","dark:border-gray-800","cursor-pointer","hover:shadow-lg","transition",3,"click"],[1,"text-lg","font-semibold","text-gray-800","dark:text-gray-200"],[1,"text-sm","text-gray-500","dark:text-gray-400","mt-1"],[1,"text-xs","text-gray-400","dark:text-gray-500","mt-1"]],template:function(e,o){e&1&&(S(0,"div",0),O("click",function(){return o.open.emit()}),S(1,"h3",1),a(2),w(),S(3,"p",2),a(4),w(),S(5,"p",3),a(6),I(7,"date"),w()()),e&2&&(s(2),g(" ",o.ticket.subject," "),s(2),g(" Status: ",o.ticket.status," "),s(2),g(" Created: ",E(7,3,o.ticket.creationDate,"short")," "))},dependencies:[b,D],encapsulation:2})};var X=(t,i)=>i.id;function Z(t,i){if(t&1&&(n(0,"div",4)(1,"p",17),a(2),r(),n(3,"p",18),a(4),r(),n(5,"p",19),a(6),I(7,"date"),r()()),t&2){let e=i.$implicit;s(2),g(" From: ",e.senderEmail," "),s(2),g(" ",e.body," "),s(2),g(" ",E(7,3,e.creationDate,"short")," ")}}function ee(t,i){if(t&1){let e=f();n(0,"app-success-modal",20),c("continue",function(){k(e);let p=l();return _(p.success=!1)}),r()}if(t&2){let e=l();d("message",e.successMessage)}}function te(t,i){if(t&1){let e=f();n(0,"app-success-modal",20),c("continue",function(){k(e);let p=l();return _(p.closeModal())}),r()}if(t&2){let e=l();d("message",e.successMessage)}}function ie(t,i){if(t&1){let e=f();n(0,"app-error-modal",21),c("cancel",function(){k(e);let p=l();return _(p.error=!1)}),r()}if(t&2){let e=l();d("title",e.errorMessage)}}function oe(t,i){t&1&&x(0,"app-loading-modal",15),t&2&&d("message","Sending the response...")}var B=class t{supportService=y(V);ticketId;close=new T;isClosing=!1;messages=[];replyBody="";loading=!1;success=!1;error=!1;ticketClosed=!1;successMessage="";errorMessage="";constructor(){this.handleCancel=this.handleCancel.bind(this)}ngOnInit(){this.loadConversation()}handleCancel(){this.isClosing=!0,setTimeout(()=>{this.close.emit(),this.isClosing=!1},300)}loadConversation(){this.supportService.getConversation(this.ticketId).subscribe({next:i=>this.messages=i,error:i=>{this.error=!0,this.errorMessage="Unexpected error ocurred loading the conversation"}})}sendReply(){let i={adminEmail:"mlbportal29@gmail.com",body:this.replyBody};this.loading=!0,this.supportService.reply(this.ticketId,i).subscribe({next:e=>{this.loading=!1,this.success=!0,this.successMessage="Response Sent Correctly",this.replyBody="",this.loadConversation()},error:e=>{this.loading=!1,this.error=!0,this.errorMessage="An error occurred while sending the response."}})}closeTicket(){this.supportService.closeTicket(this.ticketId).subscribe({next:i=>{this.supportService.updateCurrentOpenTickets(),this.success=!0,this.successMessage="Ticket Successfully Closed",this.ticketClosed=!0},error:i=>{this.error=!0,this.errorMessage="Unexpected error ocurred closing this ticket."}})}closeModal(){this.close.emit()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=C({type:t,selectors:[["app-support-ticket-modal"]],inputs:{ticketId:"ticketId"},outputs:{close:"close"},decls:25,vars:7,consts:[[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/50","backdrop-blur-sm",3,"ngClass","appEscapeClose"],[1,"w-full","max-w-2xl","bg-white","dark:bg-gray-900","rounded-2xl","shadow-2xl","p-8","relative"],[1,"text-2xl","font-semibold","text-center","mb-6","bg-gradient-to-r","from-blue-500","via-indigo-500","to-purple-500","bg-clip-text","text-transparent"],[1,"max-h-80","overflow-y-auto","flex","flex-col","gap-4","pr-2"],[1,"p-4","rounded-xl","border","border-gray-200","dark:border-gray-800","bg-gray-50","dark:bg-gray-800"],[1,"mt-6"],["rows","4","placeholder","Write your reply...",1,"text-inputs","w-full","resize-none","placeholder-gray-300","dark:placeholder-gray-400",3,"ngModelChange","ngModel"],[1,"flex","justify-between","mt-6"],[1,"app-success-button","group",3,"click"],[1,"app-button-bright"],[1,"app-button-texts"],[1,"app-red-buttons","group",3,"click"],[1,"absolute","top-4","right-4","text-gray-400","hover:text-white","transition",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[3,"message"],[3,"title"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"text-gray-800","dark:text-gray-200","mt-2"],[1,"text-xs","text-gray-400","dark:text-gray-500","mt-2"],[3,"continue","message"],[3,"cancel","title"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),a(3," Support Ticket "),r(),n(4,"div",3),v(5,Z,8,6,"div",4,X),r(),n(7,"div",5)(8,"textarea",6),L("ngModelChange",function(h){return P(o.replyBody,h)||(o.replyBody=h),h}),r()(),n(9,"div",7)(10,"button",8),c("click",function(){return o.sendReply()}),x(11,"span",9),n(12,"span",10),a(13,"Send Reply"),r()(),n(14,"button",11),c("click",function(){return o.closeTicket()}),x(15,"span",9),n(16,"span",10),a(17," Close Ticket "),r()()(),n(18,"button",12),c("click",function(){return o.handleCancel()}),F(),n(19,"svg",13),x(20,"path",14),r()()(),m(21,ee,1,1,"app-success-modal",15),m(22,te,1,1,"app-success-modal",15),m(23,ie,1,1,"app-error-modal",16),m(24,oe,1,1,"app-loading-modal",15),r()),e&2&&(d("ngClass",o.isClosing?"animate-fade-out-down":"animate-fade-in-up")("appEscapeClose",o.handleCancel),s(5),M(o.messages),s(3),j("ngModel",o.replyBody),s(13),u(o.success?21:-1),s(),u(o.ticketClosed?22:-1),s(),u(o.error?23:-1),s(),u(o.loading?24:-1))},dependencies:[b,R,A,W,$,z,q,G,Y,U,D],encapsulation:2})};var ne=(t,i)=>i.id;function re(t,i){t&1&&(n(0,"div",3),x(1,"img",7),n(2,"h2",8),a(3," No Tickets at the moment "),r(),n(4,"p",9),a(5," You're all caught up! \u{1F389} "),r()())}function se(t,i){if(t&1){let e=f();n(0,"app-support-ticket-item",10),c("open",function(){let p=k(e).$implicit,h=l();return _(h.openTicket(p.id))}),r()}if(t&2){let e=i.$implicit;d("ticket",e)}}function ae(t,i){if(t&1){let e=f();n(0,"app-support-ticket-modal",11),c("close",function(){k(e);let p=l();return _(p.closeModal())}),r()}if(t&2){let e=l();d("ticketId",e.selectedTicketId)}}var K=class t{supportService=y(V);tickets=[];selectedTicketId=null;error=!1;errorMessage="";ngOnInit(){this.loadTickets()}loadTickets(){this.supportService.getOpenTickets().subscribe({next:i=>this.tickets=i,error:i=>{this.error=!0,this.errorMessage="Failed to load tickets"}})}openTicket(i){this.selectedTicketId=i}closeModal(){this.selectedTicketId=null,this.loadTickets()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=C({type:t,selectors:[["app-inbox"]],decls:9,vars:2,consts:[[1,"app-background","min-h-screen"],[1,"max-w-5xl","mx-auto","py-10","px-6"],[1,"app-page-titles","text-center","mb-10"],[1,"flex","flex-col","items-center","justify-center","text-center","mt-10"],[1,"flex","flex-col","gap-4","mt-6"],[3,"ticket"],[3,"ticketId"],["src","assets/no-tickets.png","alt","No Tickets Picture",1,"w-72","max-w-full","h-auto","mb-6","drop-shadow-md"],[1,"text-4xl","font-bold","text-gray-700","dark:text-gray-200","mb-2"],[1,"text-lg","text-gray-500","dark:text-gray-400"],[3,"open","ticket"],[3,"close","ticketId"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),a(3," Support Inbox "),r(),m(4,re,6,0,"div",3),n(5,"div",4),v(6,se,1,1,"app-support-ticket-item",5,ne),r(),m(8,ae,1,1,"app-support-ticket-modal",6),r()()),e&2&&(s(4),u(o.tickets.length===0?4:-1),s(2),M(o.tickets),s(2),u(o.selectedTicketId!==null?8:-1))},dependencies:[b,N,B],encapsulation:2})};export{K as InboxComponent};
