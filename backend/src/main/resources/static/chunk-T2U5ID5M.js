import{b as L}from"./chunk-NLCTFATQ.js";import{h as P}from"./chunk-4AIZDKVX.js";import{a as K}from"./chunk-GFD2RJE6.js";import{a as N}from"./chunk-BFYD4AXT.js";import{a as G}from"./chunk-VKJO2SPY.js";import{B as A,Ja as f,Ka as $,La as h,N as j,Na as C,Nb as z,Oa as w,Pa as v,Pb as H,Qa as o,R as B,Ra as r,Rb as O,Sa as g,Ub as R,W as c,Wa as u,X as m,Xa as p,Y as E,Za as s,eb as d,fb as S,gb as I,j as V,la as x,mb as y,na as D,nb as k,oa as l,qa as b,ub as M,vb as F,wa as U}from"./chunk-KBG2IHGQ.js";var T=class i{constructor(t){this.http=t}apiUrl="https://localhost:8443/api/users";favTeamsSubject=new V([]);favTeams$=this.favTeamsSubject.asObservable();getAllUsers(){return this.http.get(this.apiUrl)}getFavTeams(){this.http.get(`${this.apiUrl}/favorites/teams`,{withCredentials:!0}).subscribe({next:t=>this.favTeamsSubject.next(t)})}getSelectedFavTeams(){return this.favTeamsSubject.getValue()}addFavTeam(t){return this.http.post(`${this.apiUrl}/favorites/teams/${t.name}`,{},{withCredentials:!0})}removeFavTeam(t){return this.http.delete(`${this.apiUrl}/favorites/teams/${t.name}`,{withCredentials:!0})}static \u0275fac=function(e){return new(e||i)(B(R))};static \u0275prov=j({token:i,factory:i.\u0275fac,providedIn:"root"})};var q=(i,t)=>t.abbreviation;function W(i,t){if(i&1){let e=u();o(0,"div",3)(1,"button",8),p("click",function(){c(e);let n=s();return m(n.loadTeams())}),d(2,"Add Favorite Team"),r()()}}function X(i,t){if(i&1){let e=u();o(0,"div",10)(1,"div",13),p("click",function(){let n=c(e).$implicit,_=s(2);return m(_.selectTeam(n.name))}),g(2,"img",14),r(),o(3,"div",15)(4,"span",16),d(5),r(),o(6,"button",17),p("click",function(){let n=c(e).$implicit,_=s(2);return m(_.openDeleteModal(n))}),E(),o(7,"svg",18),g(8,"path",19),r()()()()}if(i&2){let e=t.$implicit,a=s(2);l(),v("ngClass",a.logoBackground(e)),l(),v("src",k("assets/team-logos-new/",e.league,"/",e.division,"/",e.abbreviation,".png"),x)("alt",y("",e.name," Logo")),l(3),S(e.name)}}function Z(i,t){if(i&1){let e=u();o(0,"section",4)(1,"div",9),C(2,X,9,8,"div",10,q),M(4,"async"),r(),o(5,"div",11)(6,"button",12),p("click",function(){c(e);let n=s();return m(n.loadTeams())}),d(7,"Add Favorite Team"),r()()()}if(i&2){let e=s();l(2),w(F(4,0,e.favTeams$))}}function ee(i,t){if(i&1){let e=u();o(0,"li")(1,"button",24),p("click",function(){let n=c(e).$implicit,_=s(2);return m(_.addFavoriteTeam(n))}),g(2,"img",25),o(3,"span",26),d(4),r()()()}if(i&2){let e=t.$implicit,a=s(2);l(),v("ngClass",a.logoBackground(e)),l(),v("src",k("assets/team-logos-new/",e.league,"/",e.division,"/",e.abbreviation,".png"),x)("alt",y("",e.name," Logo")),l(2),S(e.name)}}function te(i,t){if(i&1){let e=u();o(0,"div",23)(1,"button",27),p("click",function(){c(e);let n=s(2);return m(n.loadMoreTeams())}),d(2," Load more teams "),r()()}}function ie(i,t){if(i&1){let e=u();o(0,"div",23)(1,"button",27),p("click",function(){c(e);let n=s(2);return m(n.addButtonClicked=!1)}),d(2," Close "),r()()}}function ae(i,t){if(i&1&&(o(0,"div",5)(1,"div",20)(2,"h2",21),d(3," Select a Team to Add "),r(),o(4,"ul",22),C(5,ee,5,8,"li",null,q),r(),f(7,te,3,0,"div",23)(8,ie,3,0,"div",23),r()()),i&2){let e=s();v("ngClass",e.isClose?"animate-fade-out-down":"animate-fade-in-up"),l(5),w(e.visibleTeams),l(2),h(e.visibleTeams.length<e.availableTeams.length?7:8)}}function ne(i,t){if(i&1){let e=u();o(0,"app-success-modal",28),p("continue",function(){c(e);let n=s();return m(n.showSuccessModal=!1)}),r()}if(i&2){let e=s();v("message",e.successMessage)}}function oe(i,t){if(i&1){let e=u();o(0,"app-remove-confirmation-modal",29),p("confirm",function(){c(e);let n=s();return m(n.confirmDeleteTeam())})("cancel",function(){c(e);let n=s();return m(n.cancelDeleteModal())}),r()}if(i&2){let e=s();v("title","Are you sure you want to remove this team as favorite?")("contentMessage","This action cannot be undone. The team will be removed from your favorites.")("buttonContent","Yes, Remove")("svg",e.removeModalIcon)}}var Y=class i{constructor(t,e,a,n){this.userService=t;this.backgroundService=e;this.teamService=a;this.authService=n}favTeams$;username="";errorMessage="";successMessage="";showDeleteModal=!1;teamToDelete;showSuccessModal=!1;addButtonClicked=!1;availableTeams=[];visibleTeams=[];pageSize=10;currentPage=0;isClose=!1;removeModalIcon=`<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" class="w-12 h-12 mx-auto">
		<path fill-rule="evenodd" clip-rule="evenodd"
			d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z"
		></path>
	</svg>`;ngOnInit(){this.favTeams$=this.userService.favTeams$,this.userService.getFavTeams(),this.getUsername()}getUsername(){this.authService.getActiveUser().subscribe({next:t=>this.username=t.username,error:t=>this.errorMessage="Unexpected error while retrieving the user"})}updateAvailableTeams(t){this.favTeams$.pipe(A(1)).subscribe(e=>{this.availableTeams=t.filter(a=>!e.some(n=>n.name===a.name)),this.currentPage=0,this.visibleTeams=this.availableTeams.slice(0,this.pageSize)})}loadTeams(){this.addButtonClicked=!0,this.errorMessage="",this.teamService.getTeamsNamesAndAbbr().subscribe({next:t=>this.updateAvailableTeams(t),error:t=>this.errorMessage="Error while loading the teams"})}addFavoriteTeam(t){this.errorMessage="",this.successMessage="",this.userService.addFavTeam(t).subscribe({next:e=>{this.successMessage="Team successfully added",this.showSuccessModal=!0,this.userService.getFavTeams(),this.teamService.getTeamsNamesAndAbbr().subscribe(a=>{this.updateAvailableTeams(a)})},error:e=>this.errorMessage=e.message})}closeTeamModal(){this.isClose=!0,setTimeout(()=>{this.addButtonClicked=!1,this.isClose=!1},300)}handleEscape(t){t.key==="Escape"&&this.closeTeamModal()}openDeleteModal(t){this.showDeleteModal=!0,this.teamToDelete=t}cancelDeleteModal(){this.showDeleteModal=!1}confirmDeleteTeam(){this.errorMessage="",this.successMessage="",this.userService.removeFavTeam(this.teamToDelete).subscribe({next:t=>{this.showDeleteModal=!1,this.successMessage="Team successfully removed",this.showSuccessModal=!0,this.userService.getFavTeams(),this.teamService.getTeamsNamesAndAbbr().subscribe(e=>{this.updateAvailableTeams(e)})},error:t=>this.errorMessage=t.message})}logoBackground(t){return this.backgroundService.getBackgroundColor(t.abbreviation)}selectTeam(t){this.teamService.selectTeam(t).subscribe({error:e=>this.errorMessage=e.message})}loadMoreTeams(){this.currentPage++;let t=this.currentPage*this.pageSize,e=t+this.pageSize;this.visibleTeams=[...this.visibleTeams,...this.availableTeams.slice(t,e)]}static \u0275fac=function(e){return new(e||i)(b(T),b(N),b(L),b(P))};static \u0275cmp=U({type:i,selectors:[["app-fav-team"]],hostBindings:function(e,a){e&1&&p("keydown",function(_){return a.handleEscape(_)},D)},decls:10,vars:7,consts:[[1,"app-background","min-h-screen","text-gray-900","dark:text-white","px-6","py-16","space-y-24","flex","flex-col","items-center"],[1,"w-full","flex","justify-center","text-center","overflow-visible"],[1,"app-page-titles"],[1,"flex","justify-center"],[1,"w-full","max-w-6xl","team-section-container"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/50","backdrop-blur-sm",3,"ngClass"],[3,"message"],[3,"title","contentMessage","buttonContent","svg"],[1,"px-6","py-3","app-button","hover:scale-105",3,"click"],[1,"grid","grid-cols-2","md:grid-cols-4","lg:grid-cols-6","gap-x-14","gap-y-16","justify-center"],[1,"flex","flex-col","items-center","space-y-3","relative","text-center"],[1,"mt-12","flex","justify-center"],[1,"px-6","py-3","app-button",3,"click"],["id","team-container",1,"w-32","h-32","rounded-full","shadow-lg","flex","items-center","justify-center","cursor-pointer",3,"click","ngClass"],[1,"w-24","h-24","object-contain","cursor-pointer","hover:animate-scale",3,"src","alt"],[1,"flex","items-center","justify-center","gap-2"],[1,"text-lg","font-semibold","text-center"],["title","Remove team",1,"text-red-500","hover:text-red-700","transition","cursor-pointer",3,"click"],["fill","currentColor","viewBox","0 0 20 20","xmlns","http://www.w3.org/2000/svg",1,"w-5","h-5"],["fill-rule","evenodd","d","M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"bg-white","dark:bg-gray-900","rounded-xl","shadow-2xl","w-11/12","max-w-2xl","p-6","overflow-y-auto","max-h-[80vh]"],[1,"text-2xl","font-bold","mb-6","text-center","text-blue-800","dark:text-blue-300"],[1,"space-y-2"],[1,"mt-6","text-center"],[1,"w-full","flex","items-center","justify-start","gap-4","px-4","py-3","rounded-lg","transition","cursor-pointer","hover:brightness-110","hover:shadow-md",3,"click","ngClass"],[1,"w-8","h-8",3,"src","alt"],[1,"text-white","font-medium","text-base","truncate"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-gray-200","rounded-lg","bg-gradient-to-br","from-sky-600","via-sky-700","to-sky-800","hover:brightness-125","hover:shadow-lg","transition-all","duration-300","ease-out","cursor-pointer","dark:from-indigo-900","dark:via-blue-900","dark:to-sky-800",3,"click"],[3,"continue","message"],[3,"confirm","cancel","title","contentMessage","buttonContent","svg"]],template:function(e,a){if(e&1&&(o(0,"div",0)(1,"section",1)(2,"h1",2),d(3),r()(),f(4,W,3,0,"div",3),M(5,"async"),$(6,Z,8,2,"section",4),f(7,ae,9,2,"div",5),f(8,ne,1,1,"app-success-modal",6),f(9,oe,1,4,"app-remove-confirmation-modal",7),r()),e&2){let n;l(3),I(" ",a.username,"'s Favorite Teams "),l(),h(((n=F(5,5,a.favTeams$))==null?null:n.length)===0?4:6),l(3),h(a.addButtonClicked?7:-1),l(),h(a.showSuccessModal?8:-1),l(),h(a.showDeleteModal?9:-1)}},dependencies:[O,z,G,K,H],encapsulation:2})};export{Y as FavTeamComponent};
