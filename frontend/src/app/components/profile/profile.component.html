<div class="min-h-screen app-background flex flex-col items-center justify-center gap-12 p-6">
    <div class="flex flex-col items-center gap-4">

        <!-- Picture Container -->
        <div class="relative group">
            <img
                [src]="getPictureUrl()"
                alt="Profile picture"
                class="w-36 h-36 rounded-full object-cover shadow-xl ring-4 ring-white dark:ring-gray-700 cursor-pointer hover:opacity-90 transition"
                (click)="fileInput.click()"
            />

            <!-- Upload Picture Button -->
            <button
                class="absolute bottom-2 right-2 bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-full shadow-md opacity-90 group-hover:opacity-100 transition"
                (click)="fileInput.click()"
            >
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none"
                     viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1M12 12V4m0 0l-3 3m3-3l3 3" />
                </svg>
            </button>
            <input
                #fileInput
                type="file"
                accept="image/webp"
                class="hidden"
                (change)="handleProfilePicture($event)"
            />
        </div>

        <!-- Format Message -->
        <p class="text-sm text-gray-500 dark:text-gray-400">
            Only <span class="font-semibold">.webp</span> files are allowed
        </p>

        <!-- Welcome Message -->
        <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 tracking-tight">
            Welcome,
            <span
                class="bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 bg-clip-text text-transparent"
            >
                {{ username }}
            </span>
        </h1>
    </div>

    <!-- Main Container -->
    <div class="w-full max-w-lg bg-white dark:bg-gray-800 rounded-3xl shadow-xl p-8 flex flex-col gap-8">

        <h2
            class="text-2xl font-semibold text-center bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 bg-clip-text text-transparent"
        >
            Profile Information
        </h2>

        <div class="flex flex-col gap-2">
            <label class="text-gray-700 dark:text-gray-300 font-medium">Email</label>
            <input
                type="email"
                [placeholder]="currentEmail"
                [(ngModel)]="emailInput"
                class="text-inputs"
            />
        </div>

        <div class="flex flex-col gap-2">
            <label class="text-gray-700 dark:text-gray-300 font-medium">Password</label>
            <input
                type="password"
                [(ngModel)]="passwordInput"
                placeholder="•••••••••• (new password)"
                class="text-inputs"
            />
        </div>

        <!-- Confirm Changes Button -->
        <button class="w-full py-3 app-success-button" (click)="editProfile()">
            Save Changes
        </button>
    </div>

    <!-- Logout and Delete Buttons -->
    <div class="flex flex-row items-center justify-center gap-5">
        <app-profile-buttons
            [content]="'Logout'"
            (confirm)="openModal('logout')"
        ></app-profile-buttons>

        <app-profile-buttons
            [content]="'Delete Account'"
            (confirm)="openModal('delete')"
        ></app-profile-buttons>
    </div>

    <!-- Modals -->
    @if (activeAction) {
        <app-remove-confirmation-modal
            [title]="
                activeAction === 'logout'
                    ? 'Are you sure you want to log out?'
                    : 'Are you sure you want to delete your account?'
            "
            [contentMessage]="
                activeAction === 'logout'
                    ? 'You will be signed out of your account and will need to log in again to continue.'
                    : 'Your account will be deleted from the system and this is an irreversible change.'
            "
            [buttonContent]="activeAction === 'logout' ? 'Yes, Logout' : 'Yes, Delete'"
            [isDelete]="activeAction === 'delete'"
            (confirm)="confirm()"
            (cancel)="cancel()"
        ></app-remove-confirmation-modal>
    }

    @if (sucess) {
        <app-success-modal [message]="successMessage" (continue)="sucess = false"></app-success-modal>
    }

	@if (error) {
		<app-error-modal [title]="errorMessage" (cancel)="error = false"></app-error-modal>
	}

	@if (loading) {
		<app-loading-modal [message]="'Uploading the image...'"></app-loading-modal>
	}
</div>