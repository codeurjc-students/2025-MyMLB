<div class="min-h-screen app-background flex flex-col items-center justify-center gap-12 p-6">
    <div class="flex flex-col items-center gap-4">

        <!-- Picture Container -->
        <div class="relative group w-36 h-36">
            <img
				[src]="getPictureUrl()"
				alt="Profile picture"
				class="w-36 h-36 rounded-full object-cover shadow-xl ring-4 ring-white dark:ring-gray-700 cursor-pointer hover:opacity-90 transition"
				(click)="fileInput.click()"
			/>

			<button
				type="button"
				class="absolute bottom-2 right-2 z-10 bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-full shadow-md transition-all active:scale-95"
				(click)="$event.stopPropagation(); fileInput.click()"
			>
				<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none"
					viewBox="0 0 24 24" stroke="currentColor" style="pointer-events: none;">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
						d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1M12 12V4m0 0l-3 3m3-3l3 3" />
				</svg>
			</button>

			@if (pictureSrc !== null) {
				<button
					type="button"
					class="absolute top-2 right-2 cursor-pointer bg-red-600 hover:bg-red-700 text-white p-2 rounded-full shadow-md opacity-90 group-hover:opacity-100 transition"
					(click)="removeProfilePicture()">
					<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
						stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
						<path stroke-linecap="round" stroke-linejoin="round"
							d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
					</svg>
				</button>
			}
        </div>

		<input
            #fileInput
            type="file"
            accept="image/webp"
            class="hidden"
            (change)="handleProfilePicture($event)"
        />

        <!-- Format Message -->
        <p class="text-sm text-gray-500 dark:text-gray-400">
            Only files under <span class="font-semibold">1MB</span>
        </p>

        <!-- Welcome Message -->
        <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 tracking-tight">
            Welcome,
            <span
                class="bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 bg-clip-text text-transparent"
            >
                {{ username }}
            </span>
        </h1>
    </div>

    <!-- Main Container -->
    <div class="w-full max-w-lg bg-white dark:bg-gray-800 rounded-3xl shadow-xl p-8 flex flex-col gap-8">

        <h2
            class="text-2xl font-semibold text-center bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 bg-clip-text text-transparent"
        >
            Profile Information
        </h2>

        <div class="flex flex-col gap-2">
            <label class="text-gray-700 dark:text-gray-300 font-medium">Email</label>
            <input
                type="email"
                [placeholder]="currentEmail"
                [(ngModel)]="emailInput"
                class="text-inputs"
            />
        </div>

        <div class="flex flex-col gap-2">
            <label class="text-gray-700 dark:text-gray-300 font-medium">Password</label>
            <input
                type="password"
                [(ngModel)]="passwordInput"
                placeholder="•••••••••• (new password)"
                class="text-inputs"
            />
        </div>

        <!-- Confirm Changes Button -->
        <button class="w-full app-success-button group" (click)="editProfile()">
			<span class="app-button-bright"></span>
			<span class="app-button-texts">Save Changes</span>
        </button>

		<!-- Notifications Toggle Button -->
		<div class="flex items-center justify-between bg-gray-100 dark:bg-gray-700 px-4 py-3 rounded-2xl shadow-inner">
			<span class="text-gray-700 dark:text-gray-300 font-medium text-lg">
				Notifications
			</span>

			<label class="inline-flex items-center cursor-pointer">
				<input
					type="checkbox"
					[checked]="notificationsEnabled"
					(change)="toggleNotifications()"
					class="sr-only peer"
				/>

				<div
					class="relative w-12 h-7 bg-gray-300 dark:bg-gray-600 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 peer-checked:bg-blue-600 transition
					peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white
					after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all dark:border-gray-500"
				></div>
			</label>
		</div>
    </div>

    <!-- Logout and Delete Buttons -->
    <div class="w-full max-w-lg flex flex-row items-center justify-between px-2">
		<app-profile-buttons
			[content]="'Logout'"
			[buttonType]="'logout'"
			(confirm)="openModal('logout')"
		></app-profile-buttons>

		<app-profile-buttons
			[content]="'Delete Account'"
			[buttonType]="'delete'"
			(confirm)="openModal('delete')"
		></app-profile-buttons>
	</div>

    <!-- Modals -->
    @if (activeAction) {
        <app-remove-confirmation-modal
            [title]="
                activeAction === 'logout'
                    ? 'Are you sure you want to log out?'
                    : 'Are you sure you want to delete your account?'
            "
            [contentMessage]="
                activeAction === 'logout'
                    ? 'You will be signed out of your account and will need to log in again to continue.'
                    : 'Your account will be deleted from the system and this is an irreversible change.'
            "
            [buttonContent]="activeAction === 'logout' ? 'Yes, Logout' : 'Yes, Delete'"
            [isDelete]="activeAction === 'delete'"
            (confirm)="confirm()"
            (cancel)="cancel()"
        ></app-remove-confirmation-modal>
    }

    @if (sucess) {
        <app-success-modal [message]="successMessage" (continue)="sucess = false"></app-success-modal>
    }

	@if (error) {
		<app-error-modal [title]="errorMessage" (cancel)="error = false"></app-error-modal>
	}

	@if (loading) {
		<app-loading-modal [message]="'Uploading the image...'"></app-loading-modal>
	}
</div>